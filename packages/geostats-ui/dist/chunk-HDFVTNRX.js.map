{"version":3,"sources":["../src/combo-box-tag-multi-select.tsx"],"sourcesContent":["import React, {useMemo} from 'react';\nimport {useListState, type Key} from 'react-stately';\nimport {type List, Seq, Set} from 'immutable';\nimport {type CollectionElement} from '@react-types/shared';\nimport {useId} from '@react-aria/utils';\nimport ComboBox from './combo-box.tsx';\nimport TagGroup from './tag-group.tsx';\nimport {cx} from './cva.ts';\n\nexport type ComboBoxTagMultiSelectProps<T extends Record<string, unknown>> = {\n\treadonly label?: string;\n\treadonly children: (item: T) => CollectionElement<T>;\n\treadonly items: List<T>;\n\treadonly filteredKeys: Set<Key>;\n\treadonly filterText: string;\n\treadonly setFilterText: (filterText: string) => void;\n\treadonly selectedKeys: Set<Key> | 'all';\n\treadonly setSelectedKeys: (keys: Set<Key> | 'all') => void;\n\treadonly className?: string;\n\treadonly searchPlaceholder?: string;\n};\n\nexport default function ComboBoxTagMultiSelect<\n\tT extends Record<string, unknown>,\n>(props: ComboBoxTagMultiSelectProps<T>) {\n\tconst {\n\t\titems,\n\t\tfilteredKeys,\n\t\tsetSelectedKeys,\n\t\tfilterText,\n\t\tsetFilterText,\n\t\tselectedKeys,\n\t\tchildren,\n\t\tlabel,\n\t\tclassName,\n\t\tsearchPlaceholder,\n\t} = props;\n\tconst {collection, selectionManager} = useListState<T>({\n\t\titems,\n\t\tchildren,\n\t\tselectedKeys,\n\t\tonSelectionChange(keys) {\n\t\t\tsetSelectedKeys(Set(keys));\n\t\t},\n\t\tselectionMode: 'multiple',\n\t});\n\n\tconst id = useId();\n\n\tconst selectedItems = useMemo(\n\t\t() =>\n\t\t\tSeq(selectionManager.selectedKeys)\n\t\t\t\t.map(key => collection.getItem(key)!.value!)\n\t\t\t\t.toList(),\n\t\t[collection, selectionManager],\n\t);\n\tconst filteredItems = useMemo(\n\t\t() =>\n\t\t\tSeq(filteredKeys)\n\t\t\t\t.map(key => collection.getItem(key)!.value!)\n\t\t\t\t.toList(),\n\t\t[collection, filteredKeys],\n\t);\n\n\treturn (\n\t\t<div className={cx('group w-fit', className)}>\n\t\t\t{label === undefined ? null : (\n\t\t\t\t<p\n\t\t\t\t\tclassName='text-sm text-stone-300 group-focus-within:text-stone-50'\n\t\t\t\t\tid={id}\n\t\t\t\t>\n\t\t\t\t\t{label}\n\t\t\t\t</p>\n\t\t\t)}\n\n\t\t\t<TagGroup\n\t\t\t\taria-labelledby={id}\n\t\t\t\titems={selectedItems}\n\t\t\t\tclassName={cx(\n\t\t\t\t\t(selectedKeys === 'all' || selectedKeys.size > 0) && 'mb-2',\n\t\t\t\t)}\n\t\t\t\tonRemove={keys => {\n\t\t\t\t\tfor (const key of keys) {\n\t\t\t\t\t\tselectionManager.toggleSelection(key);\n\t\t\t\t\t}\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t{children}\n\t\t\t</TagGroup>\n\t\t\t<ComboBox\n\t\t\t\taria-labelledby={id}\n\t\t\t\tplaceholder={searchPlaceholder}\n\t\t\t\titems={filteredItems}\n\t\t\t\tinputValue={filterText}\n\t\t\t\tclassName='w-full'\n\t\t\t\tonInputChange={setFilterText}\n\t\t\t\tonSelectionChange={(key: Key) => {\n\t\t\t\t\tif (key === null) {\n\t\t\t\t\t\tif (filterText !== '') {\n\t\t\t\t\t\t\tsetFilterText('');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tsetFilterText('');\n\t\t\t\t\tif (selectedKeys === 'all') {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tsetSelectedKeys(selectedKeys.add(key));\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t{children}\n\t\t\t</ComboBox>\n\t\t</div>\n\t);\n}\n"],"mappings":";;;;;;;;;;;;;;AAAA,SAAe,eAAc;AAC7B,SAAQ,oBAA6B;AACrC,SAAmB,KAAK,WAAU;AA+DhC,SAEE,KAFF;AA3Ca,SAAR,uBAEL,OAAuC;AACxC,QAAM;AAAA,IACL;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EACD,IAAI;AACJ,QAAM,EAAC,YAAY,iBAAgB,IAAI,aAAgB;AAAA,IACtD;AAAA,IACA;AAAA,IACA;AAAA,IACA,kBAAkB,MAAM;AACvB,sBAAgB,IAAI,IAAI,CAAC;AAAA,IAC1B;AAAA,IACA,eAAe;AAAA,EAChB,CAAC;AAED,QAAM,KAAK,0CAAM;AAEjB,QAAM,gBAAgB;AAAA,IACrB,MACC,IAAI,iBAAiB,YAAY,EAC/B,IAAI,SAAO,WAAW,QAAQ,GAAG,EAAG,KAAM,EAC1C,OAAO;AAAA,IACV,CAAC,YAAY,gBAAgB;AAAA,EAC9B;AACA,QAAM,gBAAgB;AAAA,IACrB,MACC,IAAI,YAAY,EACd,IAAI,SAAO,WAAW,QAAQ,GAAG,EAAG,KAAM,EAC1C,OAAO;AAAA,IACV,CAAC,YAAY,YAAY;AAAA,EAC1B;AAEA,SACC,qBAAC,SAAI,WAAW,GAAG,eAAe,SAAS,GACzC;AAAA,cAAU,SAAY,OACtB;AAAA,MAAC;AAAA;AAAA,QACA,WAAU;AAAA,QACV;AAAA,QAEC;AAAA;AAAA,IACF;AAAA,IAGD;AAAA,MAAC;AAAA;AAAA,QACA,mBAAiB;AAAA,QACjB,OAAO;AAAA,QACP,WAAW;AAAA,WACT,iBAAiB,SAAS,aAAa,OAAO,MAAM;AAAA,QACtD;AAAA,QACA,UAAU,UAAQ;AACjB,qBAAW,OAAO,MAAM;AACvB,6BAAiB,gBAAgB,GAAG;AAAA,UACrC;AAAA,QACD;AAAA,QAEC;AAAA;AAAA,IACF;AAAA,IACA;AAAA,MAAC;AAAA;AAAA,QACA,mBAAiB;AAAA,QACjB,aAAa;AAAA,QACb,OAAO;AAAA,QACP,YAAY;AAAA,QACZ,WAAU;AAAA,QACV,eAAe;AAAA,QACf,mBAAmB,CAAC,QAAa;AAChC,cAAI,QAAQ,MAAM;AACjB,gBAAI,eAAe,IAAI;AACtB,4BAAc,EAAE;AAAA,YACjB;AAEA;AAAA,UACD;AAEA,wBAAc,EAAE;AAChB,cAAI,iBAAiB,OAAO;AAC3B;AAAA,UACD;AAEA,0BAAgB,aAAa,IAAI,GAAG,CAAC;AAAA,QACtC;AAAA,QAEC;AAAA;AAAA,IACF;AAAA,KACD;AAEF;","names":[]}